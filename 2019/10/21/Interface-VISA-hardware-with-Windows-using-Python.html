<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>pyVISA on Windows</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="javascript" href="/js/snap.svg-min.js">
    <link type="application/atom+xml" rel="alternate" href="/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>pyVISA on Windows</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="pyVISA on Windows" />
<meta name="author" content="fubar" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="HOWTO interface VISA compatible hardware using Python History of VISA Requirements VISA implementation from National Instruments: NI- VISA Keithley USB488A and USB488B GPIB drivers PyVISA: Python package that is a frontend to the VISA library NI- VISA Download: Permanent Documentation : Permanent Documentation: Mirror Keithley GPIB to USB drivers 488A is older version of the GPIB to USB adaptor. The driver development is supported only till Windows 7. So if trying to install the driver on later Windows versions, it might get tricky Newer version is 488B Download KUSB-488B GPIB driver Download KUSB-488A GPIB driver Installation It is essential to have no traces of previous installations of either the GPIB2USB drivers or the VISA libraries. This is ensured from checking the device manager and installed programs. In case PyVISA-py is already installed in a virtual environment, running python -m visa info will list the VISA libraries(either NI’s implementation or PyVISA-py’s own pure Python implemenation). This check is optional and needed only if one is not sure if the drivers and VISA libraries are completely uninstalled Remove the previous installation Plug the Keithley GPIB-USB adaptor and check the device manager listing. The hardware is not listed. Check the installed programs. The driver is for KUSB-488B and the hardware is KUSB-USB488A. Hence it is not listed. Unplug the adaptor and remove the installed driver. Check the system is clean Run ` python -m visa info` and see if the sytem is clean and ready for proper installation Again plug the the Keithley GPIB-USB adaptor and check the device manager listing. This confirms that the system is ready for a proper installation of hardware. Install the Keithley GPIB2USB drivers Ensure the hardware is unplugged Install the KUSB-488A driver with version 9.2.0. According to the release notes within the source directory, it is recommended to install the Keithley’s adaptor driver first followed by the NI’s own GPIB-488.2 driver to avoid vendor design conflict. Rebooting the computer is a requirement after the completion of installations After reboot, plug the hardware and check if it is installed in the device manager Install the NI-VISA library Install the NI’s implementation of the VISA specification; version 19.0 Uncheck the additional services provided by NI as these will only increase the number of unneccessary processes and services running in the background. In the older versions of NI-VISA, the option to uncheck GPIB-488.2 driver from NI was present in the installer. However the current version automatically checks for the GPIB driver pre-installed and accordingly proceeds with the installation to avoid conflict. After installation, check for the installed components. Check that the GPIB driver is from Maintainer GPIB-488 whereas NI-VISA is from NI itself. A successful installation creates visa32.dll and visa64.dll dynamically linked libraries. DLL files are shareable libraries which can be ported as it is across systems offering convience of using software without recompiling on new systems. They act like patches. After the installation, look out for the install location; usually the C:\\Windows\system32 and search for visa32.dll and visa64.dll. If they are present there, then PyVISA-py can detect them without fuss. If they are not present there (for some reason), then proceed to the alternative installation [Digression] Alternative Installation of VISA library For some reason, my VISA installation has not generated the DLLs at the location. I searched for visa* (* is called a wild card evaluating to any character set like 32.dll or 64.dll) across the WINDOWS directory and found a visa32.dll at C:\Windows\SysWOW64\visa32.dll. To demonstrate the portability of DLL files, I copied the visa32.dll to the PyVISA virtual environment (described below) and checked for the detection of the visa library. python -m visa info lists the detection of the visa32 library at the path of the virtual environment. However the bitness of Python installation (64 bit) and that of VISA (32bit) do not match. We need to fix this! Create a virtual environment Tools available with us: 32 bit VISAcd" />
<meta property="og:description" content="HOWTO interface VISA compatible hardware using Python History of VISA Requirements VISA implementation from National Instruments: NI- VISA Keithley USB488A and USB488B GPIB drivers PyVISA: Python package that is a frontend to the VISA library NI- VISA Download: Permanent Documentation : Permanent Documentation: Mirror Keithley GPIB to USB drivers 488A is older version of the GPIB to USB adaptor. The driver development is supported only till Windows 7. So if trying to install the driver on later Windows versions, it might get tricky Newer version is 488B Download KUSB-488B GPIB driver Download KUSB-488A GPIB driver Installation It is essential to have no traces of previous installations of either the GPIB2USB drivers or the VISA libraries. This is ensured from checking the device manager and installed programs. In case PyVISA-py is already installed in a virtual environment, running python -m visa info will list the VISA libraries(either NI’s implementation or PyVISA-py’s own pure Python implemenation). This check is optional and needed only if one is not sure if the drivers and VISA libraries are completely uninstalled Remove the previous installation Plug the Keithley GPIB-USB adaptor and check the device manager listing. The hardware is not listed. Check the installed programs. The driver is for KUSB-488B and the hardware is KUSB-USB488A. Hence it is not listed. Unplug the adaptor and remove the installed driver. Check the system is clean Run ` python -m visa info` and see if the sytem is clean and ready for proper installation Again plug the the Keithley GPIB-USB adaptor and check the device manager listing. This confirms that the system is ready for a proper installation of hardware. Install the Keithley GPIB2USB drivers Ensure the hardware is unplugged Install the KUSB-488A driver with version 9.2.0. According to the release notes within the source directory, it is recommended to install the Keithley’s adaptor driver first followed by the NI’s own GPIB-488.2 driver to avoid vendor design conflict. Rebooting the computer is a requirement after the completion of installations After reboot, plug the hardware and check if it is installed in the device manager Install the NI-VISA library Install the NI’s implementation of the VISA specification; version 19.0 Uncheck the additional services provided by NI as these will only increase the number of unneccessary processes and services running in the background. In the older versions of NI-VISA, the option to uncheck GPIB-488.2 driver from NI was present in the installer. However the current version automatically checks for the GPIB driver pre-installed and accordingly proceeds with the installation to avoid conflict. After installation, check for the installed components. Check that the GPIB driver is from Maintainer GPIB-488 whereas NI-VISA is from NI itself. A successful installation creates visa32.dll and visa64.dll dynamically linked libraries. DLL files are shareable libraries which can be ported as it is across systems offering convience of using software without recompiling on new systems. They act like patches. After the installation, look out for the install location; usually the C:\\Windows\system32 and search for visa32.dll and visa64.dll. If they are present there, then PyVISA-py can detect them without fuss. If they are not present there (for some reason), then proceed to the alternative installation [Digression] Alternative Installation of VISA library For some reason, my VISA installation has not generated the DLLs at the location. I searched for visa* (* is called a wild card evaluating to any character set like 32.dll or 64.dll) across the WINDOWS directory and found a visa32.dll at C:\Windows\SysWOW64\visa32.dll. To demonstrate the portability of DLL files, I copied the visa32.dll to the PyVISA virtual environment (described below) and checked for the detection of the visa library. python -m visa info lists the detection of the visa32 library at the path of the virtual environment. However the bitness of Python installation (64 bit) and that of VISA (32bit) do not match. We need to fix this! Create a virtual environment Tools available with us: 32 bit VISAcd" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-21T00:00:00+05:30" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"/2019/10/21/Interface-VISA-hardware-with-Windows-using-Python.html","headline":"pyVISA on Windows","dateModified":"2019-10-21T00:00:00+05:30","datePublished":"2019-10-21T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/10/21/Interface-VISA-hardware-with-Windows-using-Python.html"},"author":{"@type":"Person","name":"fubar"},"description":"HOWTO interface VISA compatible hardware using Python History of VISA Requirements VISA implementation from National Instruments: NI- VISA Keithley USB488A and USB488B GPIB drivers PyVISA: Python package that is a frontend to the VISA library NI- VISA Download: Permanent Documentation : Permanent Documentation: Mirror Keithley GPIB to USB drivers 488A is older version of the GPIB to USB adaptor. The driver development is supported only till Windows 7. So if trying to install the driver on later Windows versions, it might get tricky Newer version is 488B Download KUSB-488B GPIB driver Download KUSB-488A GPIB driver Installation It is essential to have no traces of previous installations of either the GPIB2USB drivers or the VISA libraries. This is ensured from checking the device manager and installed programs. In case PyVISA-py is already installed in a virtual environment, running python -m visa info will list the VISA libraries(either NI’s implementation or PyVISA-py’s own pure Python implemenation). This check is optional and needed only if one is not sure if the drivers and VISA libraries are completely uninstalled Remove the previous installation Plug the Keithley GPIB-USB adaptor and check the device manager listing. The hardware is not listed. Check the installed programs. The driver is for KUSB-488B and the hardware is KUSB-USB488A. Hence it is not listed. Unplug the adaptor and remove the installed driver. Check the system is clean Run ` python -m visa info` and see if the sytem is clean and ready for proper installation Again plug the the Keithley GPIB-USB adaptor and check the device manager listing. This confirms that the system is ready for a proper installation of hardware. Install the Keithley GPIB2USB drivers Ensure the hardware is unplugged Install the KUSB-488A driver with version 9.2.0. According to the release notes within the source directory, it is recommended to install the Keithley’s adaptor driver first followed by the NI’s own GPIB-488.2 driver to avoid vendor design conflict. Rebooting the computer is a requirement after the completion of installations After reboot, plug the hardware and check if it is installed in the device manager Install the NI-VISA library Install the NI’s implementation of the VISA specification; version 19.0 Uncheck the additional services provided by NI as these will only increase the number of unneccessary processes and services running in the background. In the older versions of NI-VISA, the option to uncheck GPIB-488.2 driver from NI was present in the installer. However the current version automatically checks for the GPIB driver pre-installed and accordingly proceeds with the installation to avoid conflict. After installation, check for the installed components. Check that the GPIB driver is from Maintainer GPIB-488 whereas NI-VISA is from NI itself. A successful installation creates visa32.dll and visa64.dll dynamically linked libraries. DLL files are shareable libraries which can be ported as it is across systems offering convience of using software without recompiling on new systems. They act like patches. After the installation, look out for the install location; usually the C:\\\\Windows\\system32 and search for visa32.dll and visa64.dll. If they are present there, then PyVISA-py can detect them without fuss. If they are not present there (for some reason), then proceed to the alternative installation [Digression] Alternative Installation of VISA library For some reason, my VISA installation has not generated the DLLs at the location. I searched for visa* (* is called a wild card evaluating to any character set like 32.dll or 64.dll) across the WINDOWS directory and found a visa32.dll at C:\\Windows\\SysWOW64\\visa32.dll. To demonstrate the portability of DLL files, I copied the visa32.dll to the PyVISA virtual environment (described below) and checked for the detection of the visa library. python -m visa info lists the detection of the visa32 library at the path of the virtual environment. However the bitness of Python installation (64 bit) and that of VISA (32bit) do not match. We need to fix this! Create a virtual environment Tools available with us: 32 bit VISAcd","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body>
    <nav class=navigation>
    <p>Site Navigation</p>
  
    <a href="/" >Home</a>
  
    <a href="/about.html" >About</a>
  
    <a href="/blog.html" >Blog</a>
  
    <a href="/staff.html" >Staff</a>
  

</nav>

<nav class=navigation-tags>
    <p>Post Tags</p>
    
        <a href="/physics.html"
           
        >
           physics
        </a>
    
        <a href="/programming.html"
           
        >
           programming
        </a>
    
        <a href="/nature.html"
           
        >
           nature
        </a>
    
 </nav>

<img class="fit-picture"
     src="assets/images/SwamiVivekananda.png"
     alt="Swami Vivekananda">

    <h1 class="Headnote">pyVISA on Windows</h1>
<p >
  21 Oct 2019 - fubar
  
  
    - <a href="/authors/fubar.html">Sreekar Guddeti</a>
  
</p>

<h1 id="howto-interface-visa-compatible-hardware-using-python">HOWTO interface VISA compatible hardware using Python</h1>

<h1 id="history-of-visa">History of VISA</h1>

<hr />

<h1 id="requirements">Requirements</h1>

<ul>
  <li>VISA implementation from National Instruments: NI- VISA</li>
  <li>Keithley USB488A and USB488B GPIB drivers</li>
  <li>PyVISA: Python package that is a frontend to the VISA library</li>
</ul>

<h1 id="ni--visa">NI- VISA</h1>

<p><a href="http://www.ni.com/en-in/support/downloads/drivers/download.ni-visa.html#305862">Download: Permanent</a></p>

<p><a href="http://www.ni.com/pdf/manuals/370423a.pdf">Documentation : Permanent</a></p>

<p><a href="/assets/documents/PyVISA/National-Instruments-2001-NI-VISA-User-Manual.pdf">Documentation: Mirror</a></p>

<h1 id="keithley-gpib-to-usb-drivers">Keithley GPIB to USB drivers</h1>

<p>488A is older version of the GPIB to USB adaptor. The driver development is supported only till Windows 7. So if trying to install the driver on later Windows versions, it might get tricky</p>

<p>Newer version is 488B</p>

<p><a href="https://www.tek.com/accessory/ki-488/3-1-3-1">Download KUSB-488B GPIB driver</a></p>

<p><a href="https://www.tek.com/accessory/gpib488/9-2-0">Download KUSB-488A GPIB driver</a></p>

<hr />

<h1 id="installation">Installation</h1>

<blockquote>
  <p>It is essential to have no traces of previous installations of either the GPIB2USB drivers or the VISA libraries. This is ensured from checking the device manager  and installed programs.</p>
</blockquote>

<blockquote>
  <p>In case PyVISA-py is already installed in a virtual environment, running
<code class="highlighter-rouge">python -m visa info</code> will list the VISA libraries(either NI’s implementation or PyVISA-py’s own pure Python implemenation).
This check is optional and needed only if one is not sure if the drivers and VISA libraries are completely uninstalled</p>
</blockquote>

<h2 id="remove-the-previous-installation">Remove the previous installation</h2>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-00.png" alt="Before Installation - Remove the VISA libraries" /></p>

<p>Plug the Keithley GPIB-USB adaptor and check the device manager listing. The hardware is not listed.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-01.png" alt="Before Installation - Check the device manager" /></p>

<p>Check the installed programs.  The driver is for KUSB-488B and the hardware is KUSB-USB488A. Hence it is not listed. Unplug the adaptor and remove the installed driver.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-02.png" alt="Before Installation - Remove the Installed Keithley Driver" /></p>

<h2 id="check-the-system-is-clean">Check the system is clean</h2>

<p>Run  ` python -m visa info` and see if the sytem is clean and ready for proper installation</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-03.png" alt="Before Installation -Check the system is clean 00" /></p>

<p>Again plug the the Keithley GPIB-USB adaptor and check the device manager listing. This confirms that the system is ready for a proper installation of hardware.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-04.png" alt="Before Installation -Check the system is clean 01" /></p>

<h2 id="install-the-keithley-gpib2usb-drivers">Install the Keithley GPIB2USB drivers</h2>

<blockquote>
  <p>Ensure the hardware is unplugged</p>
</blockquote>

<p>Install the KUSB-488A driver with version 9.2.0. According to the release notes within the source directory,</p>

<blockquote>
  <p>it is recommended to install the Keithley’s adaptor driver first followed by the NI’s own GPIB-488.2 driver to avoid vendor design conflict.</p>
</blockquote>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-05.png" alt="Install the GPIB2USB driver 00" /></p>

<blockquote>
  <p>Rebooting the computer is a requirement after the completion of installations</p>
</blockquote>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-06.png" alt="Install the GPIB2USB driver 01" /></p>

<p>After reboot, plug the hardware and check if it is installed in the device manager</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-07.png" alt="Install the GPIB2USB driver 02" /></p>

<h2 id="install-the-ni-visa-library">Install the NI-VISA library</h2>

<p>Install the NI’s implementation of the VISA specification; version 19.0</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-08.png" alt="Install NI-VISA library-00" /></p>

<p>Uncheck the additional services provided by NI as these will only increase the number of unneccessary processes and services running in the background. In the older versions of NI-VISA, the option to uncheck GPIB-488.2 driver from NI was present in the installer. However the current version automatically checks for the GPIB driver pre-installed and accordingly proceeds with the installation to avoid conflict.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-09.png" alt="Install NI-VISA library-01" /></p>

<p>After installation, check for the installed components. Check that the GPIB driver is from Maintainer GPIB-488 whereas NI-VISA is from NI itself.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-10.png" alt="Install NI-VISA library-02" /></p>

<p>A successful installation creates <code class="highlighter-rouge">visa32.dll</code> and <code class="highlighter-rouge">visa64.dll</code> dynamically linked libraries. DLL files are shareable libraries which can be ported as it is across systems offering convience of using software without recompiling on new systems. They act like patches.</p>

<p>After the installation, look out for the install location; usually the <code class="highlighter-rouge">C:\\Windows\system32</code> and search for <code class="highlighter-rouge">visa32.dll</code> and <code class="highlighter-rouge">visa64.dll</code>. If they are present there, then PyVISA-py can detect them without fuss. If they are not present there (for some reason), then proceed to the <a href="##[Digression]-Alternative-Installation-of-VISA-library">alternative installation</a></p>

<h2 id="digression-alternative-installation-of-visa-library">[Digression] Alternative Installation of VISA library</h2>

<p>For some reason, my VISA installation has not generated the DLLs at the location. I searched for visa* (* is called a wild card evaluating to any character set like 32.dll or 64.dll) across the WINDOWS directory and found a <code class="highlighter-rouge">visa32.dll</code> at <code class="highlighter-rouge">C:\Windows\SysWOW64\visa32.dll</code>.</p>

<p>To demonstrate the portability of DLL files, I copied the <code class="highlighter-rouge">visa32.dll</code> to the PyVISA virtual environment (described below) and checked for the detection of the visa library.</p>

<p><code class="highlighter-rouge">python -m visa info</code> lists the detection of the visa32 library at the path of the virtual environment.</p>

<blockquote>
  <p>However the bitness of Python installation (64 bit) and that of VISA (32bit) do not match. We need to fix this!</p>
</blockquote>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-11.png" alt="Install NI-VISA library-03" /></p>

<h2 id="create-a-virtual-environment">Create a virtual environment</h2>

<p>Tools available with us:</p>

<p>32 bit VISAcd</p>



  

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = '/2019/10/21/Interface-VISA-hardware-with-Windows-using-Python.html';
      this.page.identifier = '/2019/10/21/Interface-VISA-hardware-with-Windows-using-Python.html';
    };
    (function() {
      var d = document, s = d.createElement('script');
      s.src = 'https://baalkikhaal.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>




  </body>
</html>
