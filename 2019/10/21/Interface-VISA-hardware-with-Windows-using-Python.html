<!doctype html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Render GitHub Markdown style https://github.com/sindresorhus/github-markdown-css -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.css">
    <style>
    	.markdown-body {
    		box-sizing: border-box;
    		min-width: 200px;
    		max-width: 980px;
    		margin: 0 auto;
    		padding: 45px;
    	}

    	@media (max-width: 767px) {
    		.markdown-body {
    			padding: 15px;
    		}
    	}
    </style>

    <!-- GitHub markdown style configuration ends here -->

    <title>pyVISA on Windows</title>
    <meta name="author" content="fubar">
    <meta name="description" content="A collection of HOWTOs in programming and commonly used tools by graduate students with focus on physicists. Additionally, an attempt is made to understand the intricate connection between Adwaitha / అద్వైతా / अद्वैता philosophy, physics and Mother Nature.">
    <link rel="icon" href="/assets/images/favicon.png" type="image/x-icon">

    <!-- custom style sheet -->
    <!-- uncomment to import the css file
        <link rel="stylesheet" href="/assets/css/styles.css">
     -->
    <script src="/js/snap.svg-min.js" defer></script>
    <link type="application/atom+xml" rel="alternate" href="/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.6.1 -->
<title>pyVISA on Windows</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="pyVISA on Windows" />
<meta name="author" content="fubar" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A tutorial on interfacing VISA compatible hardware using python’s wrapper module pyVISA." />
<meta property="og:description" content="A tutorial on interfacing VISA compatible hardware using python’s wrapper module pyVISA." />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-21T00:00:00+05:30" />
<script type="application/ld+json">
{"@type":"BlogPosting","url":"/2019/10/21/Interface-VISA-hardware-with-Windows-using-Python.html","headline":"pyVISA on Windows","dateModified":"2019-10-21T00:00:00+05:30","datePublished":"2019-10-21T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"/2019/10/21/Interface-VISA-hardware-with-Windows-using-Python.html"},"author":{"@type":"Person","name":"fubar"},"description":"A tutorial on interfacing VISA compatible hardware using python’s wrapper module pyVISA.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>
  <body class="markdown-body">
    <img class="fit-picture"
     src="/assets/images/swamiVivekananda.svg"
     alt="Swami Vivekananda">

<nav class=navigation>
  
  <!-- uncomment below line to render the names of the navigation items -->
<!--
    <a href="/" >Home</a>
-->
    <a
        href="/" >
            <img src="/assets/images/homePageHomeLogo.svg" alt="homepage logo">
    </a>
  
  <!-- uncomment below line to render the names of the navigation items -->
<!--
    <a href="/about.html" >About</a>
-->
    <a
        href="/about.html" >
            <img src="/assets/images/homePageAboutLogo.svg" alt="about logo">
    </a>
  
  <!-- uncomment below line to render the names of the navigation items -->
<!--
    <a href="/blog.html" >Blog</a>
-->
    <a
        href="/blog.html" >
            <img src="/assets/images/homePagePostsLogo.svg" alt="blog logo">
    </a>
  
  <!-- uncomment below line to render the names of the navigation items -->
<!--
    <a href="/staff.html" >Staff</a>
-->
    <a
        href="/staff.html" >
            <img src="/assets/images/homePageStaffLogo.svg" alt="staff logo">
    </a>
  

</nav>

<nav class=navigation-tags>
    <p>Post Tags</p>
    
        <a href="/physics.html"
           
        >
           physics
        </a>
    
        <a href="/programming.html"
           
        >
           programming
        </a>
    
        <a href="/yoga.html"
           
        >
           yoga
        </a>
    
        <a href="/education.html"
           
        >
           education
        </a>
    
        <a href="/nature.html"
           
        >
           nature
        </a>
    
 </nav>

    <h1 class="Headnote">pyVISA on Windows</h1>
<p >
  21 Oct 2019 - fubar
  
  
    - <a href="/authors/fubar.html">Sreekar Guddeti</a>
  
</p>

<div class="box">
<img src="/assets/images/Python/pythonLogo.svg" alt="python-logo" width="150px" />
</div>

<h2 id="abstract">Abstract</h2>

<p>Interfacing test and measurement s</p>

<h2 id="history-of-visa">History of VISA</h2>

<hr />

<h2 id="requirements">Requirements</h2>

<ul>
  <li>VISA implementation from National Instruments: NI- VISA</li>
  <li>Keithley USB488A and USB488B GPIB drivers</li>
  <li>PyVISA: Python package that is a frontend to the VISA library</li>
</ul>

<h3 id="ni--visa">NI- VISA</h3>

<p><a href="http://www.ni.com/en-in/support/downloads/drivers/download.ni-visa.html#305862">Download: Permanent</a></p>

<p><a href="http://www.ni.com/pdf/manuals/370423a.pdf">Documentation : Permanent</a></p>

<p><a href="/assets/documents/PyVISA/National-Instruments-2001-NI-VISA-User-Manual.pdf">Documentation: Mirror</a></p>

<h3 id="keithley-gpib-to-usb-drivers">Keithley GPIB to USB drivers</h3>

<p>488A is older version of the GPIB to USB adaptor. The driver development is supported only till Windows 7. So if trying to install the driver on later Windows versions, it might get tricky</p>

<p>Newer version is 488B</p>

<p><a href="https://www.tek.com/accessory/ki-488/3-1-3-1">Download KUSB-488B GPIB driver</a></p>

<p><a href="https://www.tek.com/accessory/gpib488/9-2-0">Download KUSB-488A GPIB driver</a></p>

<hr />

<h2 id="installation">Installation</h2>

<ol>
  <li>Remove the previous installation</li>
  <li>Check the system is clean</li>
  <li>Install the Keithley GPIB2USB drivers</li>
  <li>Install the NI-VISA library
    <ul>
      <li>[Digression] Alternative Installation of VISA library</li>
    </ul>
  </li>
  <li>Install PyVISA
    <ul>
      <li>Install python virtual environment</li>
    </ul>
  </li>
</ol>

<blockquote>
  <p>It is essential to have no traces of previous installations of either the GPIB2USB drivers or the VISA libraries. This is ensured from checking the device manager  and installed programs.</p>
</blockquote>

<blockquote>
  <p>In case PyVISA-py is already installed in a virtual environment, running
<code class="highlighter-rouge">python -m visa info</code> will list the VISA libraries(either NI’s implementation or PyVISA-py’s own pure Python implemenation).
This check is optional and needed only if one is not sure if the drivers and VISA libraries are completely uninstalled</p>
</blockquote>

<h3 id="remove-the-previous-installation">Remove the previous installation</h3>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-00.png" alt="Before Installation - Remove the VISA libraries" /></p>

<p>Plug the Keithley GPIB-USB adaptor and check the device manager listing. The hardware is not listed.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-01.png" alt="Before Installation - Check the device manager" /></p>

<p>Check the installed programs.  The driver is for KUSB-488B and the hardware is KUSB-USB488A. Hence it is not listed. Unplug the adaptor and remove the installed driver.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-02.png" alt="Before Installation - Remove the Installed Keithley Driver" /></p>

<h3 id="check-the-system-is-clean">Check the system is clean</h3>

<p>Run  ` python -m visa info` and see if the sytem is clean and ready for proper installation</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-03.png" alt="Before Installation -Check the system is clean 00" /></p>

<p>Again plug the the Keithley GPIB-USB adaptor and check the device manager listing. This confirms that the system is ready for a proper installation of hardware.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-04.png" alt="Before Installation -Check the system is clean 01" /></p>

<h3 id="install-the-keithley-gpib2usb-drivers">Install the Keithley GPIB2USB drivers</h3>

<blockquote>
  <p>Ensure the hardware is unplugged</p>
</blockquote>

<p>Install the KUSB-488A driver with version 9.2.0. According to the release notes within the source directory,</p>

<blockquote>
  <p>it is recommended to install the Keithley’s adaptor driver first followed by the NI’s own GPIB-488.2 driver to avoid vendor design conflict.</p>
</blockquote>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-05.png" alt="Install the GPIB2USB driver 00" /></p>

<blockquote>
  <p>Rebooting the computer is a requirement after the completion of installations</p>
</blockquote>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-06.png" alt="Install the GPIB2USB driver 01" /></p>

<p>After reboot, plug the hardware and check if it is installed in the device manager</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-07.png" alt="Install the GPIB2USB driver 02" /></p>

<h3 id="install-the-ni-visa-library">Install the NI-VISA library</h3>

<p>Install the NI’s implementation of the VISA specification; version 19.0</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-08.png" alt="Install NI-VISA library-00" /></p>

<p>Uncheck the additional services provided by NI as these will only increase the number of unneccessary processes and services running in the background. In the older versions of NI-VISA, the option to uncheck GPIB-488.2 driver from NI was present in the installer. However the current version automatically checks for the GPIB driver pre-installed and accordingly proceeds with the installation to avoid conflict.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-09.png" alt="Install NI-VISA library-01" /></p>

<p>After installation, check for the installed components. Check that the GPIB driver is from Maintainer GPIB-488 whereas NI-VISA is from NI itself.</p>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-10.png" alt="Install NI-VISA library-02" /></p>

<p>A successful installation creates <code class="highlighter-rouge">visa32.dll</code> and <code class="highlighter-rouge">visa64.dll</code> dynamically linked libraries. DLL files are shareable libraries which can be ported as it is across systems offering convience of using software without recompiling on new systems. They act like patches.</p>

<p>After the installation, look out for the install location; usually the <code class="highlighter-rouge">C:\\Windows\system32</code> and search for <code class="highlighter-rouge">visa32.dll</code> and <code class="highlighter-rouge">visa64.dll</code>. If they are present there, then PyVISA-py can detect them without fuss. If they are not present there (for some reason), then proceed to the <a href="##[Digression]-Alternative-Installation-of-VISA-library">alternative installation</a></p>

<h3 id="digression-alternative-installation-of-visa-library">[Digression] Alternative Installation of VISA library</h3>

<p>For some reason, my VISA installation has not generated the DLLs at the location. I searched for visa* (* is called a wild card evaluating to any character set like 32.dll or 64.dll) across the WINDOWS directory and found a <code class="highlighter-rouge">visa32.dll</code> at <code class="highlighter-rouge">C:\Windows\SysWOW64\visa32.dll</code>.</p>

<p>To demonstrate the portability of DLL files, I copied the <code class="highlighter-rouge">visa32.dll</code> to the PyVISA virtual environment (described below) and checked for the detection of the visa library.</p>

<p><code class="highlighter-rouge">python -m visa info</code> lists the detection of the visa32 library at the path of the virtual environment.</p>

<blockquote>
  <p>However the bitness of Python installation (64 bit) and that of VISA (32bit) do not match. We need to fix this!</p>
</blockquote>

<p><img src="/assets/images/PyVISA/InstallationPyVISA-11.png" alt="Install NI-VISA library-03" /></p>

<h2 id="create-a-virtual-environment">Create a virtual environment</h2>

<p>Tools available with us:</p>

<p>32 bit VISAcd</p>



  



  </body>
</html>
